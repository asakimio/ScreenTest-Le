<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        @media (prefers-color-scheme: light) {
            body {
                background: #fff;
                color: #000;
            }
        }

        @media (prefers-color-scheme: dark) {
            body {
                background: #000;
                color: white;
            }
        }

        @media (prefers-color-scheme: no-preference) {
            body {
                background: #fff;
                color: #000;
            }
        }

        #bor {
            border-bottom: solid #808080;
            border-width: 1in;
        }

        /* #borsetdpi {
            border-bottom: solid #808080;
            border-width: 160px;
        } */

        #bor96 {
            border-bottom: solid #808080;
            border-width: 96px;
        }

        #bor128 {
            border-bottom: solid #808080;
            border-width: 128px;
        }

        #bor160 {
            border-bottom: solid #808080;
            border-width: 160px;
        }

        #bor163 {
            border-bottom: solid #808080;
            border-width: 163px;
        }

        .num {
            /* color: chocolate; */
            color: #5f50e7;
        }

        body {
            word-wrap: break-word;
            word-break: normal;
        }

        .dettext {
            display: none;
        }

        .diydpi,
        #z1 {
            color: chocolate;
        }
    </style>

</head>

<body>

    <form onsubmit="return checkSubmit()">
        <label for="z1">自定义dpi</label>
        <input type="number" value="128" max="9999" min="1" name="indpi" id="z1" onblur="setdpi()" onclick="setdpi()" />
        <!-- <input type="text" value="113" style="width: 30px" name="indpi" id="z1" onblur="setdpi()" onclick="setdpi()" /> -->
        <input type="button" value="-" id="dpim" onclick="fdpim()" />
        <input type="button" value="+" id="dpip" onclick="fdpip()" />
        <!-- <input type="button" value="确定" id="dpiok" onclick="setdpi()" /> -->
        <span id="diyinch">0.00</span>
        <input type="checkbox" id="det" onclick="detOnclick(this)">
        <label for="det">显示代码</label>
    </form>
    <p id="borsetdpi">自定义dpi高度线条<span></span></p>

    <fieldset>
        <legend>全屏幕</legend>

        <p>逻辑分辨率和比例<span class="dettext">(screen.width+'x'+screen.height)</span>：<span id="s2" class="num"></span></p>

        <p>物理分辨率<span class="dettext">(width*window.devicePixelRatio+'x'+height*window.devicePixelRatio)</span>：<span
                id="s3" class="num"></span>
        </p>

        <p>dpr,取自定义,常用dpi的PPI<span class="dettext">(window.devicePixelRatio,~*dpiList)</span>：<span id="s4"
                class="num"></span>
        </p>

        <p>斜边dip量,取自定义,常用dpi的尺寸<span class="dettext">(√(screen.width^2+screen.height^2),~/dpiList)</span>：<span id="s16"
                class="num"></span>
        </p>
    </fieldset>
    <!-- <br /> -->
    <fieldset>
        <legend>窗口</legend>
        <p>逻辑分辨率和比例<span
                class="dettext">(document.documentElement.clientWidth+'x'+document.documentElement.clientHeight)</span>：<span
                id="s1" class="num"></span>
        </p>

        <p>斜边dip量,取自定义,常用dpi的尺寸<span class="dettext">(√(screen.width^2+screen.height^2),~/dpiList)</span>：<span id="s17"
                class="num"></span>
        </p>
    </fieldset>

    <fieldset>
        <legend>其他信息</legend>
        Date对象<span class="dettext">(new Date())</span>:<span id="theDate" class="num"></span>
        时间戳<span class="dettext">(new Date().getTime())</span>:<span id="timeStamp" class="num"></span>
        <br />
        色深<span class="dettext">(screen.colorDepth)</span>:<span id="s5" class="num"></span>
        位深<span class="dettext">(screen.pixelDepth)</span>:<span id="s7" class="num"></span>
        刷新率<span class="dettext">(screen.updateInterval)</span>:<span id="s15" class="num"></span>
        整个页面滚动的dip<span class="dettext">(window.pageXOffset+'x'+window.pageYOffset)</span>:<span id="s13"
            class="num"></span>
        屏幕可用工作区<span class="dettext">(screen.availWidth+'x'+screen.availHeight)</span>:<span id="s6" class="num"></span>
        窗口在显示器中的位置<span class="dettext">(window.screenX+'x'+window.screenY)</span>:<span id="s14" class="num"></span>
        <br />
        窗口的视口,包括水平滚动条dip<span class="dettext">(window.innerWidth+'x'+window.innerHeight)</span>:<span id="s8"
            class="num"></span>

        窗口外部dip<span class="dettext">(window.outerWidth+'x'+window.outerHeight)</span>:<span id="s9" class="num"></span>

        文档中body部分dip<span class="dettext">(document.body.offsetWidth+'x'+document.body.offsetHeight)</span>:<span
            id="s10" class="num"></span>

        文档可显示区域dip<span
            class="dettext">(document.documentElement.clientWidth+'x'+document.documentElement.clientHeight)</span>:<span
            id="s11" class="num"></span>

        文档本身(html部分)dip<span
            class="dettext">(document.documentElement.offsetWidth+'x'+document.documentElement.offsetHeight)</span>:<span
            id="s12" class="num"></span>
        <br />
        UserAgent<span class="dettext">(navigator.userAgent)</span>:<span id="userAgent" class="num"></span>
        <br />

        浏览器代号<span class="dettext">(navigator.appCodeName)</span>:<span id="appCodeName" class="num"></span>
        浏览器名称<span class="dettext">(navigator.appName)</span>:<span id="appName" class="num"></span>
        启用Cookies<span class="dettext">(navigator.cookieEnabled)</span>:<span id="cookieEnabled" class="num"></span>
        浏览器厂商<span class="dettext">(navigator.vendor)</span>:<span id="vendor" class="num"></span>
        硬件平台<span class="dettext">(navigator.platform)</span>:<span id="platform" class="num"></span>
        用户代理语言<span class="dettext">(navigator.language)</span>:<span id="language" class="num"></span>
        <br />
        浏览器版本<span class="dettext">(navigator.appVersion)</span>:<span id="appVersion" class="num"></span>
    </fieldset>
    <p id="bor">1 in<span></span></p>
    <p id="bor96">96 px<span></span></p>
    <p id="bor128">128 px<span></span></p>
    <p id="bor160">160 px<span></span></p>
    <p id="bor163">163 px<span></span></p>

    <a href="https://github.com/asakimio/ScreenTest-Le" target="_blank">在GitHub上查看</a>
    <br /><br /><br />

</body>

</html>
<script>

    function checkSubmit() {
        //在输入框中回车时触发的submit事件
        event.preventDefault();//阻止表单的默认行为
        setdpi();
    }

    window.onload = function () {
        //进入页面加载
        setdpi();
        setDate();
    }
    onresize = function () {
        //窗口拖动时加载
        setdpi();
    }
    function setdpi() {
        //计算入口
        var thedpi = document.getElementById("z1").value;
        var diyList = JSON.parse('[96,113,128,160,163]');
        //console.log(thedpi);
        fenbianlv(thedpi, diyList);
        // console.log(strDpiList(diyList,'*',2,0));
    }

    //对常用dpi列表计算，转字符串数组输出
    function strDpiList(diyList, op, b, Fix) {
        // console.log('diyListlength'+diyList.length)
        var calList = [];
        for (let i = 0; i < diyList.length; i++) {
            switch (op) {
                case "*": calList.push(diyList[i] + ': ' + (b * diyList[i]).toFixed(Fix)); break;
                case "/": calList.push(diyList[i] + ': ' + (b / diyList[i]).toFixed(Fix)); break;
            }
        }
        return '[' + calList.join(', ') + ']';
    }

    function setDate() {
        document.getElementById("theDate").innerHTML = new Date();
        document.getElementById("timeStamp").innerHTML = new Date().getTime();
        setTimeout(function () { setDate() }, 1);
    }
    function fenbianlv(thedpi, diyList) {
        //计算并渲染到页面
        var W = document.documentElement.clientWidth;
        var H = document.documentElement.clientHeight;
        var arr1 = reductionTo(W, H);
        document.getElementById("s1").innerHTML = W + 'x' + H + '（' + arr1[0] + ':' + arr1[1] + '）';

        var width = screen.width;
        var height = screen.height;
        var arr2 = reductionTo(width, height);
        document.getElementById("s2").innerHTML = width + 'x' + height + '（' + arr2[0] + ':' + arr2[1] + '）';

        var dpr = window.devicePixelRatio;
        document.getElementById("s3").innerHTML = width * dpr + 'x' + height * dpr;
        document.getElementById("s4").innerHTML = dpr + '，<span class="diydpi">' + dpr * thedpi + '，</span>' + strDpiList(diyList, '*', dpr, 0);

        document.getElementById("s5").innerHTML = screen.colorDepth;

        document.getElementById("s6").innerHTML = screen.availWidth + 'x' + screen.availHeight;

        document.getElementById("s7").innerHTML = screen.pixelDepth;
        document.getElementById("s8").innerHTML = window.innerWidth + 'x' + window.innerHeight;
        document.getElementById("s9").innerHTML = window.outerWidth + 'x' + window.outerHeight;
        document.getElementById("s10").innerHTML = document.body.offsetWidth + 'x' + document.body.offsetHeight;

        document.getElementById("s11").innerHTML = document.documentElement.clientWidth + 'x' + document.documentElement.clientHeight;
        document.getElementById("s12").innerHTML = document.documentElement.offsetWidth + 'x' + document.documentElement.offsetHeight;

        document.getElementById("s13").innerHTML = window.pageXOffset + 'x' + window.pageYOffset;

        document.getElementById("s14").innerHTML = window.screenX + 'x' + window.screenY;

        document.getElementById("s15").innerHTML = screen.updateInterval;

        var hypopx = Math.ceil(Math.sqrt(Math.pow(screen.width, 2) + Math.pow(screen.height, 2)));

        document.getElementById("s16").innerHTML = hypopx + '，<span class="diydpi">' + (hypopx / thedpi).toFixed(2) + '，</span>' + strDpiList(diyList, '/', hypopx, 2);

        document.getElementById("diyinch").innerHTML = '(' + '<span class="diydpi">' + (hypopx / thedpi).toFixed(2) + '</span>' + '英寸)';

        var hypopx2 = Math.ceil(Math.sqrt(Math.pow(W, 2) + Math.pow(H, 2)));

        document.getElementById("s17").innerHTML = hypopx2 + '，<span class="diydpi">' + (hypopx2 / thedpi).toFixed(2) + '，</span>' + strDpiList(diyList, '/', hypopx2, 2);


        document.getElementById("borsetdpi").setAttribute("style", "border-bottom: solid #808080;border-width: " + thedpi + "px;");

        document.getElementById("userAgent").innerHTML = navigator.userAgent;
        document.getElementById("appVersion").innerHTML = navigator.appVersion;
        document.getElementById("appCodeName").innerHTML = navigator.appCodeName;
        document.getElementById("appName").innerHTML = navigator.appName;
        document.getElementById("cookieEnabled").innerHTML = navigator.cookieEnabled;
        document.getElementById("vendor").innerHTML = navigator.vendor;
        document.getElementById("platform").innerHTML = navigator.platform;
        document.getElementById("language").innerHTML = navigator.language;

    }


    function fdpip() {
        //加按钮
        var maxn = document.getElementById("z1").max;
        var thedpip = document.getElementById("z1").value;
        if (thedpip < maxn) {
            document.getElementById("z1").value = Number(thedpip) + 1;
            setdpi();
        }
    }

    function fdpim() {
        //减按钮
        var minn = document.getElementById("z1").min;
        var thedpim = document.getElementById("z1").value;
        if (thedpim > minn) {
            document.getElementById("z1").value = Number(thedpim) - 1;
            setdpi();
        }
    }
    function detOnclick(checkbox) {
        //控制是否在页面显示预设的代码
        var dettext = document.getElementsByClassName("dettext");

        if (checkbox.checked == true) {
            Array.prototype.forEach.call(dettext, function (element) {
                element.setAttribute("style", "display: block;");
            })
        }
        if (checkbox.checked == false) {
            Array.prototype.forEach.call(dettext, function (element) {
                // element.setAttribute("style", "display: inline;");
                element.setAttribute("style", "display: none;");
            })
        }
    }


    // onclick = function () {
    //     fenbianlv();
    // }
    // document.onmousemove=function(){
    //     fenbianlv();
    // }

    function reductionTo(m, n) {
        //分数约分工具，用于计算屏幕比例
        var arr = [];
        if (!isInteger(m) || !isInteger(n)) {
            // console.log('m和n必须为整数');
            return;
        } else if (m <= 0 || n <= 0) {
            // console.log('m和n必须大于0');
            return;
        }
        var a = m;
        var b = n;
        (a >= b) ? (a = m, b = n) : (a = n, b = m);
        if (m != 1 && n != 1) {
            for (var i = b; i >= 2; i--) {
                if (m % i == 0 && n % i == 0) {
                    m = m / i;
                    n = n / i;
                }
            }
        }
        arr[0] = m;
        arr[1] = n;
        return arr;
    }
    function isInteger(obj) {
        return obj % 1 === 0
    }
</script>